<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ì‚°ì¹˜í•€ì¹˜ì‚°ì¹˜í•€ì¹˜ì‚°ì¹˜í•€ì¹˜ì‚°ì¹˜í•€ì¹˜ì‚°ì¹˜í•€ì¹˜ì‚°ì¹˜í•€ì¹˜ì‚°ì¹˜í•€ì¹˜</title>
    <style>
      body {
        margin: 0;
        overflow-x: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: #29cfb9;
        width: 100vw;
        height: 100vh;
      }

      #container {
        width: 100vw;
        height: 100vh;
      }

      svg {
        display: none;
      }
    </style>
  </head>
  <body>
    <div id="container"></div>

    <!-- path cdn -->
    <script src="https://cdn.jsdelivr.net/npm/pathseg@1.2.1/pathseg.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/poly-decomp@0.3.0/build/decomp.min.js"></script>

    <!-- matter.js cdn -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.17.1/matter.js"></script>
    <script>
      // ğŸ“•ë³´í†µ matter.jsì—ì„œ íŒ¨ìŠ¤ë¥¼ ì§€ì •í•  ë•Œ ì“´ë‹¤.
      const reactangle =
        "M82 0C65.9837 0 53 12.9837 53 29C53 32.5144 53.6251 35.8828 54.7703 39C56.7703 45.4615 53 46 49 46H29C12.9837 46 0 58.9837 0 75C0 91.0163 12.9837 104 29 104H357C373.016 104 386 91.0163 386 75C386 58.9837 373.016 46 357 46H336C332 46 328.23 45.4615 330.23 39C331.375 35.8828 332 32.5144 332 29C332 12.9837 319.016 0 303 0H82Z";
      const curved =
        "m341.46,31.89c14.51,28.65,3.05,63.65-25.6,78.16-3.42,1.73-34.78,17.16-83.49,26.15-28.57,5.27-57.68,7.34-86.51,6.14-36.13-1.5-71.89-8.14-106.28-19.74C9.15,112.33-7.2,79.34,3.07,48.9,13.33,18.47,46.33,2.12,76.77,12.39c101.89,34.37,185.72-5.68,186.54-6.1,28.65-14.51,63.65-3.05,78.16,25.6Z";

      // ğŸ“•--- ì´ˆê¸° ì„¸íŒ… ---
      var Engine = Matter.Engine
        World = Matter.World,
        Bodies = Matter.Bodies;
      Body = Matter.Body;
      Composites = Matter.Composites;
      Common = Matter.Common;
      Vertices = Matter.Vertices;
      Svg = Matter.Svg;
      Composite = Matter.Composite;
      // --- ì´ˆê¸° ì„¸íŒ… ---

      // ğŸ“•Engine.create() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ Matter.js ì—”ì§„ì„ ìƒì„±í•œë‹¤.
      const engine = Engine.create( { gravity: { y : 0.01} } );
      // ğŸ“•ë Œë”ë§í•  ì»¨í…Œì´ë„ˆ ì—­í•  ë¶€ë¶„ì˜ idë¥¼ ê°€ì ¸ì˜¨ë‹¤.(getElementById)
      const container = document.getElementById("container");

      // ğŸ“•Matter.Render.create() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‹œê°ì ì¸ ë Œë”ë§ì„ ë‹´ë‹¹í•˜ëŠ” ê°ì²´ë¥¼ ìƒì„±í•œë‹¤.
      const renderer = Matter.Render.create({
        element: container, // ë Œë”ëŸ¬ê°€ ê·¸ë¦´ HTMLìš”ì†Œë¥¼ ì§€ì •í•´ì¤€ë‹¤.
        engine: engine, // ë Œë”ëŸ¬ì— ì‚¬ìš©ë  Matter.js ì—”ì§„ì„ ì§€ì •í•´ì¤€ë‹¤.
        options: {
          // ì»¤ìŠ¤í…€ ì˜µì…˜ë“¤ì„ ì„¤ì •í•´ì¤€ë‹¤.
          width: container.offsetWidth,
          height: container.offsetHeight,
          wireframes: false, //wireframe ì—¬ë¶€
          background: "#29cfb9",
        },
      });

      // ğŸ“•ê²½ê³„ ë²½ ìƒì„±í•˜ëŠ” ë¶€ë¶„ (ìˆœì„œëŒ€ë¡œ ì™¼ìª½, ì˜¤ë¥¸ìª½, ì•„ë˜, ìœ„ìª½ ë²½)
      const walls = [
        Bodies.rectangle(0, 0, 1, container.offsetHeight * 2, {
          isStatic: true,
        }),
        Bodies.rectangle(
          container.offsetWidth,
          0,
          1,
          container.offsetHeight * 2,
          { isStatic: true }
        ),
        Bodies.rectangle(
          0,
          container.offsetHeight,
          container.offsetWidth * 2,
          1,
          { isStatic: true }
        ),
        // ìƒë‹¨ ë²½ ì¶”ê°€
        Bodies.rectangle(
          container.offsetWidth / 2,
          0,
          container.offsetWidth * 2,
          1,
          { isStatic: true }
        ),
      ];

      // ğŸ“•ë¬¼ë¦¬ì  íŠ¹ì„±ì„ ì„¤ì •í•˜ëŠ” ê°ì²´ì¸ physicsë¥¼ ì •ì˜í•œë‹¤.
      const physics = {
        restitution: 0.7, // ë³µì›ë ¥ ë˜ëŠ” íƒ„ì„±ë ¥ (0~1 ì‚¬ì´ì— ì§€ì •í•´ì¤Œ. 1ì— ê°€ê¹Œì›Œì§ˆ ìˆ˜ë¡ ì¶©ëŒ í›„ ë¹ ë¥´ê²Œ ì›ë˜ í˜•íƒœë¡œ ëŒì•„ê°„ë‹¤.)
        friction: 0.7, // ë§ˆì°° ê³„ìˆ˜ (0~1 ì‚¬ì´ì— ì§€ì •í•´ì¤Œ. 1ì— ê°€ê¹Œì›Œì§ˆ ìˆ˜ë¡ ê°•í•œ ë§ˆì°°ì´ ë°œìƒí•œë‹¤.)
      };

      // ë„ë„›ëª¨ì–‘ ìƒì„±í•˜ëŠ” ë¶€ë¶„ì¸ ë“¯!
      const createCircle = (width, color, x, y) => {
        const outerCircle = Bodies.circle(x, y, width, {
          ...physics,
          render: {
            fillStyle: color,
          },
        });
        const innerCircle = Bodies.circle(x, y, width / 2.5, {
          ...physics,
          render: {
            fillStyle: "#eee7e0",
          },
        });

        return Body.create({
          parts: [outerCircle, innerCircle],
        });
      };

      // ì†Œì„¸ì§€ëª¨ì–‘ ìƒì„±í•˜ëŠ” ë¶€ë¶„ì¸ë“¯!
      const createSvgElement = (path, color, scale, x, y, angle) => {
        pathElement = document.createElementNS(
          "http://www.w3.org/2000/svg",
          "path"
        );
        pathElement.setAttribute("d", path);
        const vertices = Svg.pathToVertices(pathElement, 3);
        vertices.forEach((vertical) => {
          const i = vertices.findIndex(
            (v) => v.x === vertical.x && v.y === vertical.y
          );

          if (i !== -1) {
            vertices.splice(i, 1);
          }
        });
        const body = Bodies.fromVertices(
          x,
          y,
          vertices,
          {
            ...physics,
            render: {
              fillStyle: color,
              strokeStyle: color,
              lineWidth: "1px",
            },
          },
          true
        );

        Body.scale(body, 1, 1);
        Body.setAngle(body, angle);

        return body;
      };

      // ëª¨ì–‘ ìƒì„±í•˜ëŠ” í•¨ìˆ˜ë¥¼ ë°”íƒ•ìœ¼ë¡œ ìš”ì†Œë“¤ì„ ìƒì„±í•´ì£¼ëŠ” ë¶€ë¶„ì¸ë“¯
      const elements = [
        createSvgElement(curved, "#583d91", 1, 250, 200, 30),
        createSvgElement(reactangle, "#eb5c48", 1, 450, 200, 50),
        createCircle(115, "#9a3d90", 500, 200),
        createSvgElement(curved, "#583d91", 1, 700, 200, 50),
        createCircle(135, "#eb5c48", 1150, 200),
        createSvgElement(curved, "#583d91", 1, 1460, 200, 200),

        createSvgElement(curved, "#583d91", 1, 1300, 300, 300),
        createSvgElement(reactangle, "#fab71a", 1, 1600, 300, 100),

        createCircle(115, "#fab71a", 100, 500),
        createSvgElement(curved, "#eb5c48", 1, 250, 500, 250),
        createCircle(135, "#fab71a", 600, 500),
        createSvgElement(curved, "#eb5c48", 1, 1500, 500, 100),
      ];

      // ğŸ“•MouseConstraintì€ ë§ˆìš°ìŠ¤ ì…ë ¥ì„ ê¸°ë°˜ìœ¼ë¡œ ë¬¼ë¦¬ ì‹œë®¬ë ˆì´ì…˜ì— ì˜í–¥ì„ ì£¼ëŠ” ì œì•½(Constraint)ì„ ì œê³µí•œë‹¤.
      const mouseConstraint = Matter.MouseConstraint.create(engine, {
        element: container,
        constraint: {
          stiffness: 0.5, // ì œì–´ì˜ ê°•ë„ ë˜ëŠ” ê°•ì„±(stiffness)ì„ ë‚˜íƒ€ë‚´ëŠ” ê°’ (ë‚®ì„ìˆ˜ë¡ ìœ ì—°)
          render: {
            visible: false, // ì œì–´ ìš”ì†Œ(ë§ˆìš°ìŠ¤)ì˜ ê°€ì‹œì„± ì—¬ë¶€
          },
        },
      });

      // ğŸ“•World.add()ë¡œ ë¬¼ë¦¬ ì—”ì§„ ì„¸ê³„ì— ë‹¤ì–‘í•œ ë¬¼ì²´ë“¤ì„ ì¶”ê°€(ë°°ì—´ ì•ˆì— ì„¤ì •í•´ë†“ì€ ë³€ìˆ˜ë“¤ì„ í¼ì¹¨ì—°ì‚°ìë¡œ ì¶”ê°€í•œë‹¤.)
      World.add(engine.world, [...walls, mouseConstraint, ...elements]);
      // ğŸ“•Engine.run()ë¡œ Matter.js ì—”ì§„ì„ ì‹¤í–‰
      Engine.run(engine);

      // ğŸ“•Render.run()í˜¸ì¶œí•˜ì—¬ ë Œë”ëŸ¬ ì‹¤í–‰
      Matter.Render.run(renderer);
    </script>
  </body>
</html>
